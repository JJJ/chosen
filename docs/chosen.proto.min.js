/* Chosen v2.2.1 | (c) 2011-2025 JJJ | MIT License, https://github.com/jjj/chosen/blob/master/LICENSE.md */
!function(){var i,a=class{constructor(e){this.options_index=0,this.parsed=[],this.copy_data_attributes=e.copy_data_attributes||!1}add_node(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)}add_group(e){var t,s,i,l,h,r=this.parsed.length;for(this.parsed.push({array_index:r,group:!0,label:e.label,title:e.title||void 0,children:0,disabled:e.disabled,hidden:e.hidden,classes:e.className}),h=[],t=0,s=(l=e.childNodes).length;t<s;t++)i=l[t],h.push(this.add_option(i,r,e.disabled));return h}add_option(e,t,s){if("OPTION"===e.nodeName.toUpperCase())return""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML.replace(/^\s+|\s+$/g,""),title:e.title||void 0,selected:e.selected,disabled:!0===s?s:e.disabled,hidden:e.hidden,group_array_index:t,group_label:null!=t?this.parsed[t].label:null,classes:e.className,style:e.style.cssText,data:this.parse_data_attributes(e)})):this.parsed.push({options_index:this.options_index,empty:!0,data:this.parse_data_attributes(e)}),this.options_index+=1}parse_data_attributes(e){var t,s,i,l,h,r={"data-option-array-index":this.parsed.length,"data-value":e.value};if(this.copy_data_attributes&&e)for(i=0,l=(h=e.attributes).length;i<l;i++)s=(t=h[i]).nodeName,/data-.*/.test(s)&&(r[s]=t.nodeValue);return r}};a.select_to_array=function(e,t){for(var s,i=new a(t),l=e.childNodes,h=0,r=l.length;h<r;h++)s=l[h],i.add_node(s);return i.parsed},i=function(){class s{constructor(e,t={}){this.label_click_handler=this.label_click_handler.bind(this),this.form_field=e,this.options=t,s.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.can_select_by_group=null!==this.form_field.getAttribute("select-by-group"),this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}set_default_values(){return this.click_test_action=e=>this.test_active_click(e),this.activate_action=e=>this.activate_field(e),this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.is_rtl=this.options.rtl||/\bchosen-rtl\b/.test(this.form_field.className),this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_in_values=this.options.search_in_values||!1,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.inherit_option_classes=this.options.inherit_option_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options,this.parser_config=this.options.parser_config||{},this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY,this.case_sensitive_search=this.options.case_sensitive_search||!1,this.hide_results_on_select=null==this.options.hide_results_on_select||this.options.hide_results_on_select,this.normalize_search_text=this.options.normalize_search_text||function(e){return e},this.create_option=this.options.create_option||!1,this.persistent_create_option=this.options.persistent_create_option||!1,this.skip_no_results=this.options.skip_no_results||!1,this.max_search_length=this.options.max_search_length||1e3}set_default_text(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||s.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||s.default_single_text,this.default_text=this.unescape_html(this.default_text),this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||s.default_no_result_text,this.create_option_text=this.form_field.getAttribute("data-create_option_text")||this.options.create_option_text||s.default_create_option_text}choice_label(e){return this.include_group_label_in_selected&&null!=e.group_label?`<b class='group-name'>${this.escape_html(e.group_label)}</b>`+e.html:e.html}mouse_enter(){return this.mouse_on_container=!0}mouse_leave(){return this.mouse_on_container=!1}input_focus(e){if(this.is_multiple){if(!this.active_field)return setTimeout(()=>this.container_mousedown(),50)}else if(!this.active_field)return this.activate_field()}input_blur(e){if(!this.mouse_on_container)return this.active_field=!1,setTimeout(()=>this.blur_test(),100)}label_click_handler(e){return this.is_multiple?this.container_mousedown(e):this.activate_field()}results_option_build(e){for(var t,s,i="",l=0,h=this.results_data,r=0,a=h.length;r<a&&((s="")!==(s=(t=h[r]).group?this.result_add_group(t):this.result_add_option(t))&&(l++,i+=s),null!=e&&e.first&&(t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(t))),!(l>=this.max_shown_results));r++);return i}result_add_option(e){var t,s,i;if(!e.search_match)return"";if(!this.include_option_in_results(e))return"";for(t in s=[],e.disabled||e.selected&&this.is_multiple||s.push("active-result"),!e.disabled||e.selected&&this.is_multiple||s.push("disabled-result"),e.selected&&s.push("result-selected"),null!=e.group_array_index&&s.push("group-option"),""!==e.classes&&s.push(e.classes),(i=document.createElement("li")).className=s.join(" "),e.style&&(i.style.cssText=e.style),e.data)e.data.hasOwnProperty(t)&&i.setAttribute(t,e.data[t]);return i.setAttribute("role","option"),i.innerHTML=e.highlighted_html||e.html,i.id=this.form_field.id+"-chosen-search-result-"+e.data["data-option-array-index"],e.title&&(i.title=e.title),this.outerHTML(i)}result_add_group(e){var t,s;return(e.search_match||e.group_match)&&0<e.active_options?((t=[]).push("group-result"),e.classes&&t.push(e.classes),(s=document.createElement("li")).className=t.join(" "),s.innerHTML=e.highlighted_html||this.escape_html(e.label),e.title&&(s.title=e.title),this.outerHTML(s)):""}append_option(e){return this.select_append_option(e)}results_update_field(){if(this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing)return this.winnow_results()}reset_single_select_options(){for(var e,t=this.results_data,s=[],i=0,l=t.length;i<l;i++)(e=t[i]).selected?s.push(e.selected=!1):s.push(void 0);return s}results_toggle(){return this.results_showing?this.results_hide():this.results_show()}results_search(e){return this.results_showing?this.winnow_results():this.results_show(),this.form_field_jq.trigger("chosen:search",{chosen:this})}winnow_results(e){var t,s,i,l,h,r,a,o,n,_,c,u,d,p,f,m,g,v,b,w,x,k,y,N,C,A;for(this.no_results_clear(),w=0,c=i=!1,(f=this.get_search_text()).length>this.max_search_length&&(f=f.substring(0,this.max_search_length)),t=this.normalize_search_text(f).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),b=this.get_search_regex(t),s=new RegExp(`^${t}$`),this.get_highlight_regex(t),h=0,n=(m=this.results_data).length;h<n;h++)if((p=m[h]).search_match=!1,x=null,p.highlighted_html="",this.include_option_in_results(p)&&(p.group&&(p.group_match=!1,p.active_options=0),null!=p.group_array_index&&this.results_data[p.group_array_index]&&(0===(x=this.results_data[p.group_array_index]).active_options&&x.search_match&&(w+=1),x.active_options+=1),A=p.group?p.label:p.text,!p.group||this.group_search))if(u=this.normalize_search_text(A),k=this.search_string_match(u,b),p.search_match=null!=k,!p.search_match&&this.search_in_values&&(p.search_match=this.search_string_match(p.value,b),c=!0),p.search_match&&!p.group&&(w+=1),i=i||s.test(p.html),p.search_match){if(f.length&&!c){if(y=k.index,_=f.length,u!==A){for(o=u,l=r=d=0,g=A.length-1;r<=g;l=r+=1)if(o===(N=this.normalize_search_text(A.substr(l)))&&d++,o=N,!1===b.test(N)){y=l-d;break}for(l=a=1,v=A.length-y;a<=v;l=a+=1)if(N=this.normalize_search_text(A.substr(y,l)),!1!==b.test(N)){_=l;break}}k=A.slice(0,y),u=A.slice(y,y+_),C=A.slice(y+_),p.highlighted_html=`${this.escape_html(k)}<em>${this.escape_html(u)}</em>`+this.escape_html(C)}null!=x&&(x.group_match=!0)}else null!=p.group_array_index&&this.results_data[p.group_array_index].search_match&&(p.search_match=!0);if(this.result_clear_highlight(),w<1&&f.length?(this.update_results_content(""),this.fire_search_updated(f),this.create_option&&this.skip_no_results||this.no_results(f)):(this.update_results_content(this.results_option_build()),this.fire_search_updated(f),null!=e&&e.skip_highlight||this.winnow_results_set_highlight()),this.create_option&&(w<1||!i&&this.persistent_create_option)&&f.length)return this.show_create_option(f)}get_search_regex(e){var t,e=this.search_contains?e:`(^|\\s|\\b)${e}[^\\s]*`;return this.enable_split_word_search||this.search_contains||(e="^"+e),t=this.case_sensitive_search?"":"i",new RegExp(e,t)}get_highlight_regex(e){var t=this.search_contains?"":"\\b",s=this.case_sensitive_search?"":"i";return new RegExp(t+e,s)}get_list_special_char(){var e=[];return e.push({val:"ae",let:"(ä|æ|ǽ)"}),e.push({val:"oe",let:"(ö|œ)"}),e.push({val:"ue",let:"(ü)"}),e.push({val:"Ae",let:"(Ä)"}),e.push({val:"Ue",let:"(Ü)"}),e.push({val:"Oe",let:"(Ö)"}),e.push({val:"AE",let:"(Æ|Ǽ)"}),e.push({val:"ss",let:"(ß)"}),e.push({val:"IJ",let:"(Ĳ)"}),e.push({val:"ij",let:"(ĳ)"}),e.push({val:"OE",let:"(Œ)"}),e.push({val:"A",let:"(À|Á|Â|Ã|Ä|Å|Ǻ|Ā|Ă|Ą|Ǎ)"}),e.push({val:"a",let:"(à|á|â|ã|å|ǻ|ā|ă|ą|ǎ|ª)"}),e.push({val:"C",let:"(Ç|Ć|Ĉ|Ċ|Č)"}),e.push({val:"c",let:"(ç|ć|ĉ|ċ|č)"}),e.push({val:"D",let:"(Ð|Ď|Đ)"}),e.push({val:"d",let:"(ð|ď|đ)"}),e.push({val:"E",let:"(È|É|Ê|Ë|Ē|Ĕ|Ė|Ę|Ě)"}),e.push({val:"e",let:"(è|é|ê|ë|ē|ĕ|ė|ę|ě)"}),e.push({val:"G",let:"(Ĝ|Ğ|Ġ|Ģ)"}),e.push({val:"g",let:"(ĝ|ğ|ġ|ģ)"}),e.push({val:"H",let:"(Ĥ|Ħ)"}),e.push({val:"h",let:"(ĥ|ħ)"}),e.push({val:"I",let:"(Ì|Í|Î|Ï|Ĩ|Ī|Ĭ|Ǐ|Į|İ)"}),e.push({val:"i",let:"(ì|í|î|ï|ĩ|ī|ĭ|ǐ|į|ı)"}),e.push({val:"J",let:"(Ĵ)"}),e.push({val:"j",let:"(ĵ)"}),e.push({val:"K",let:"(Ķ)"}),e.push({val:"k",let:"(ķ)"}),e.push({val:"L",let:"(Ĺ|Ļ|Ľ|Ŀ|Ł)"}),e.push({val:"l",let:"(ĺ|ļ|ľ|ŀ|ł)"}),e.push({val:"N",let:"(Ñ|Ń|Ņ|Ň)"}),e.push({val:"n",let:"(ñ|ń|ņ|ň|ŉ)"}),e.push({val:"O",let:"(Ò|Ó|Ô|Õ|Ō|Ŏ|Ǒ|Ő|Ơ|Ø|Ǿ)"}),e.push({val:"o",let:"(ò|ó|ô|õ|ō|ŏ|ǒ|ő|ơ|ø|ǿ|º)"}),e.push({val:"R",let:"(Ŕ|Ŗ|Ř)"}),e.push({val:"r",let:"(ŕ|ŗ|ř)"}),e.push({val:"S",let:"(Ś|Ŝ|Ş|Š)"}),e.push({val:"s",let:"(ś|ŝ|ş|š|ſ)"}),e.push({val:"T",let:"(Ţ|Ť|Ŧ)"}),e.push({val:"t",let:"(ţ|ť|ŧ)"}),e.push({val:"U",let:"(Ù|Ú|Û|Ũ|Ū|Ŭ|Ů|Ű|Ų|Ư|Ǔ|Ǖ|Ǘ|Ǚ|Ǜ)"}),e.push({val:"u",let:"(ù|ú|û|ũ|ū|ŭ|ů|ű|ų|ư|ǔ|ǖ|ǘ|ǚ|ǜ)"}),e.push({val:"Y",let:"(Ý|Ÿ|Ŷ)"}),e.push({val:"y",let:"(ý|ÿ|ŷ)"}),e.push({val:"W",let:"(Ŵ)"}),e.push({val:"w",let:"(ŵ)"}),e.push({val:"Z",let:"(Ź|Ż|Ž)"}),e.push({val:"z",let:"(ź|ż|ž)"}),e.push({val:"f",let:"(ƒ)"}),e}escape_special_char(e){for(var t,s=this.get_list_special_char(),i=0,l=s.length;i<l;i++)t=s[i],e.replace(new RegExp(t.let,"g"),t.val);return e}search_string_match(e,t){var s=t.exec(e);return this.case_sensitive_search||null==s||(s=t.exec(this.escape_special_char(e))),!this.search_contains&&null!=s&&s[1]&&(s.index+=1),s}choices_count(){var e,t,s;if(null==this.selected_option_count)for(e=this.selected_option_count=0,t=(s=this.form_field.options).length;e<t;e++)s[e].selected&&(this.selected_option_count+=1);return this.selected_option_count}choices_click(e){if(e.preventDefault(),this.activate_field(),!this.results_showing&&!this.is_disabled)return this.results_show()}mousedown_checker(e){var t,s=null;switch((e=e||window.event).which||void 0===e.button||(e.which=null!=(t=1&e.button)?t:{1:null!=(t=2&e.button)?t:{3:null!=(t=4&e.button)?t:{2:0}}}),e.which){case 1:s="left";break;case 2:s="right";break;case 3:s="middle";break;default:s="other"}return s}keydown_checker(e){var t=null!=(t=e.which)?t:e.keyCode;switch(this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.get_search_field_value().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:case 27:this.results_showing&&e.preventDefault();break;case 32:this.disable_search&&e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}}keyup_checker(e){var t=null!=(t=e.which)?t:e.keyCode;switch(this.search_field_scale(),t){case 8:this.is_multiple&&this.backstroke_length<1&&0<this.choices_count()?this.keydown_backstroke():this.pending_backstroke||(this.result_clear_highlight(),this.results_search());break;case 13:e.preventDefault(),this.results_showing&&this.result_select(e);break;case 27:this.results_showing&&this.results_hide();break;case 9:case 16:case 17:case 18:case 38:case 40:case 91:break;default:this.results_search()}}clipboard_event_checker(e){if(!this.is_disabled)return setTimeout(()=>this.results_search(),50)}container_width(){return null!=this.options.width?this.options.width:0<this.form_field.offsetWidth?this.form_field.offsetWidth+"px":"auto"}include_option_in_results(e){return!(this.is_multiple&&!this.display_selected_options&&e.selected||!this.display_disabled_options&&e.disabled||e.empty||e.hidden||null!=e.group_array_index&&this.results_data[e.group_array_index].hidden)}search_results_touchstart(e){return this.touch_started=!0,this.search_results_mouseover(e)}search_results_touchmove(e){return this.touch_started=!1,this.search_results_mouseout(e)}search_results_touchend(e){if(this.touch_started)return this.search_results_mouseup(e)}outerHTML(e){var t;return e.outerHTML||((t=document.createElement("div")).appendChild(e),t.innerHTML)}get_single_html(){return`<a class="chosen-single chosen-default" role="button">
  <span>${this.escape_html(this.default_text)}</span>
  <div aria-label="Show options">
    <b aria-hidden="true"></b>
  </div>
</a>
<div class="chosen-drop">
  <div class="chosen-search">
    <input
      aria-autocomplete="list"
      aria-expanded="false"
      aria-haspopup="listbox"
      autocomplete="off"
      class="chosen-search-input"
      type="text"
      role="combobox"
    />
  </div>
  <ul
    aria-busy="true"
    class="chosen-results"
    role="listbox"
  >
  </ul>
</div>`}get_multi_html(){return`<ul class="chosen-choices">
  <li class="search-field">
    <input
      aria-autocomplete="list"
      aria-expanded="false"
      aria-haspopup="listbox"
      autocomplete="off"
      class="chosen-search-input"
      role="combobox"
      style="width:25px;"
      type="text"
      value="${this.escape_html(this.default_text)}"
    />
  </li>
</ul>
<div class="chosen-drop">
  <ul
    aria-busy="true"
    class="chosen-results"
    role="listbox"
  >
  </ul>
</div>`}get_no_results_html(e){return`<li class="no-results">
  ${this.results_none_found} <span>${this.escape_html(e)}</span>
</li>`}get_option_html({value:e,text:t}){return`<option value="${e}" selected>${t}</option>`}get_create_option_html(e){return`<li class="create-option active-result" role="option"><a>${this.create_option_text}</a> <span>${this.escape_html(e)}</span></li>`}static browser_is_supported(){return"Microsoft Internet Explorer"===window.navigator.appName?8<=document.documentMode:!(/iP(od|hone)/i.test(window.navigator.userAgent)||/IEMobile/i.test(window.navigator.userAgent)||/Windows Phone/i.test(window.navigator.userAgent)||/BlackBerry/i.test(window.navigator.userAgent)||/BB10/i.test(window.navigator.userAgent)||/Android.*Mobile/i.test(window.navigator.userAgent))}}return s.default_multiple_text="Select Some Options",s.default_single_text="Select an Option",s.default_no_result_text="No results for:",s.default_create_option_text="Add Option:",s.default_remove_item_text="Remove selection",s}.call(this),this.Chosen=function(){var e;class t extends i{setup(){return this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field.hasClassName("chosen-rtl"),this.form_field_jq=this.form_field}results_search(e){return this.results_showing?this.winnow_results():this.results_show(),this.form_field.fire("chosen:search",{chosen:this})}set_default_values(){return super.set_default_values(),this.single_temp=new Template('<a class="chosen-single chosen-default" role="button"> <span>#{default}</span> <div aria-label="Show options"> <b aria-hidden="true"></b> </div> </a> <div class="chosen-drop"> <div class="chosen-search"> <input aria-autocomplete="list" aria-expanded="false" aria-haspopup="listbox" autocomplete="off" class="chosen-search-input" role="combobox" type="text" /> </div> <ul aria-busy="true" class="chosen-results" role="listbox" > </ul> </div>'),this.multi_temp=new Template('<ul class="chosen-choices"> <li class="search-field"> <input aria-autocomplete="list" aria-expanded="false" aria-haspopup="listbox" autocomplete="off" class="chosen-search-input" role="combobox" style="width:25px;" type="text" value="#{default}" /> </li> </ul> <div class="chosen-drop"> <ul aria-busy="true" class="chosen-results" role="listbox" > </ul> </div>'),this.no_results_temp=new Template('<li class="no-results">'+this.results_none_found+' "<span>#{terms}</span>"</li>')}set_up_html(){var e=["chosen-container"];return e.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl"),e={class:e.join(" "),title:this.form_field.title},this.form_field.id.length&&(e.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=new Element("div",e),this.container.setStyle({width:this.container_width()}),this.is_multiple?this.container.update(this.get_multi_html()):this.container.update(this.get_single_html()),this.form_field.setStyle({position:"absolute",opacity:"0",display:"none"}).insert({after:this.container}),this.dropdown=this.container.down("div.chosen-drop"),this.search_field=this.container.down("input"),this.search_results=this.container.down("ul.chosen-results"),this.search_results.writeAttribute("id",this.form_field.id+"-chosen-search-results"),this.search_field_scale(),this.search_no_results=this.container.down("li.no-results"),this.is_multiple?(this.search_choices=this.container.down("ul.chosen-choices"),this.search_container=this.container.down("li.search-field")):(this.search_container=this.container.down("div.chosen-search"),this.selected_item=this.container.down(".chosen-single")),this.set_aria_labels(),this.results_build(),this.set_tab_index(),this.set_label_behavior()}on_ready(){return this.form_field.fire("chosen:ready",{chosen:this})}register_observers(){return this.container.observe("touchstart",e=>this.container_mousedown(e)),this.container.observe("touchend",e=>this.container_mouseup(e)),this.container.observe("mousedown",e=>this.container_mousedown(e)),this.container.observe("mouseup",e=>this.container_mouseup(e)),this.container.observe("mouseenter",e=>this.mouse_enter(e)),this.container.observe("mouseleave",e=>this.mouse_leave(e)),this.search_results.observe("mouseup",e=>this.search_results_mouseup(e)),this.search_results.observe("mouseover",e=>this.search_results_mouseover(e)),this.search_results.observe("mouseout",e=>this.search_results_mouseout(e)),this.search_results.observe("mousewheel",e=>this.search_results_mousewheel(e)),this.search_results.observe("DOMMouseScroll",e=>this.search_results_mousewheel(e)),this.search_results.observe("touchstart",e=>this.search_results_touchstart(e)),this.search_results.observe("touchmove",e=>this.search_results_touchmove(e)),this.search_results.observe("touchend",e=>this.search_results_touchend(e)),this.form_field.observe("chosen:updated",e=>this.results_update_field(e)),this.form_field.observe("chosen:activate",e=>this.activate_field(e)),this.form_field.observe("chosen:open",e=>this.container_mousedown(e)),this.form_field.observe("chosen:close",e=>this.close_field(e)),this.search_field.observe("blur",e=>this.input_blur(e)),this.search_field.observe("keyup",e=>this.keyup_checker(e)),this.search_field.observe("keydown",e=>this.keydown_checker(e)),this.search_field.observe("focus",e=>this.input_focus(e)),this.search_field.observe("cut",e=>this.clipboard_event_checker(e)),this.search_field.observe("paste",e=>this.clipboard_event_checker(e)),this.is_multiple?this.search_choices.observe("click",e=>this.choices_click(e)):this.container.observe("click",e=>e.preventDefault())}destroy(){var e,t,s;for((null!=this.container.getRootNode?this.container.getRootNode():this.container.ownerDocument).stopObserving("click",this.click_test_action),e=0,t=(s=["chosen:updated","chosen:activate","chosen:open","chosen:close"]).length;e<t;e++)this.form_field.stopObserving(s[e]);return this.container.stopObserving(),this.search_results.stopObserving(),this.search_field.stopObserving(),null!=this.form_field_label&&this.form_field_label.stopObserving(),this.is_multiple?(this.search_choices.stopObserving(),this.container.select(".search-choice-close").each(function(e){return e.stopObserving()})):this.selected_item.stopObserving(),this.search_field.tabIndex&&(this.form_field.tabIndex=this.search_field.tabIndex),this.container.remove(),this.form_field.show()}set_aria_labels(){var e,t,s,i,l,h;if(this.search_field.writeAttribute("aria-owns",this.search_results.readAttribute("id")),this.form_field.attributes["aria-label"]&&this.search_field.writeAttribute("aria-label",this.form_field.attributes["aria-label"]),this.form_field.attributes["aria-labelledby"])return this.search_field.writeAttribute("aria-labelledby",this.form_field.attributes["aria-labelledby"]);if(Object.prototype.hasOwnProperty.call(this.form_field,"labels")&&this.form_field.labels.length){for(i="",e=t=0,l=(h=this.form_field.labels).length;t<l;e=++t)""===(s=h[e]).id&&(s.id=this.form_field.id+"-chosen-label-"+e),i+=this.form_field.labels[e].id+" ";return this.search_field.writeAttribute("aria-labelledby",i)}}search_field_disabled(){var e;return this.is_disabled=this.form_field.disabled||(null!=(e=this.form_field.up("fieldset"))?e.disabled:void 0)||!1,this.is_disabled?this.container.addClassName("chosen-disabled"):this.container.removeClassName("chosen-disabled"),this.search_field.disabled=this.is_disabled,this.is_multiple||this.selected_item.stopObserving("focus",this.activate_field),this.is_disabled?this.close_field():this.is_multiple?void 0:this.selected_item.observe("focus",this.activate_field)}container_mousedown(e){var t;if(!this.is_disabled)return!e||"left"!==this.mousedown_checker(e)||!e||"mousedown"!==(t=e.type)&&"touchstart"!==t||this.results_showing||e.stop(),null!=e&&e.target.hasClassName("search-choice-close")?void 0:(this.active_field?this.is_multiple||!e||e.target!==this.selected_item&&!e.target.up("a.chosen-single")||this.results_toggle():(this.is_multiple&&this.search_field.clear(),(null!=this.container.getRootNode?this.container.getRootNode():this.container.ownerDocument).observe("click",this.click_test_action),this.results_show()),this.activate_field())}container_mouseup(e){if("ABBR"===e.target.nodeName&&!this.is_disabled)return this.results_reset(e)}search_results_mousewheel(e){var t=e.deltaY||-e.wheelDelta||e.detail;if(null!=t)return e.preventDefault(),"DOMMouseScroll"===e.type&&(t*=40),this.search_results.scrollTop=t+this.search_results.scrollTop}blur_test(e){if(!this.active_field&&this.container.hasClassName("chosen-container-active"))return this.close_field()}close_field(){return(null!=this.container.getRootNode?this.container.getRootNode():this.container.ownerDocument).stopObserving("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.search_field.writeAttribute("aria-expanded","false"),this.container.removeClassName("chosen-container-active"),this.container.removeClassName("chosen-dropup"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale(),this.search_field.blur()}should_dropup(){var e=document.viewport.getHeight(),t=this.container.cumulativeOffset()[1]+this.container.getHeight()-document.viewport.getScrollOffsets().top;return e<this.dropdown.getHeight()+t}activate_field(){if(!this.is_disabled)return this.container.addClassName("chosen-container-active"),this.should_dropup()&&this.container.addClassName("chosen-dropup"),this.active_field=!0,this.search_field.value=this.get_search_field_value(),this.search_results.writeAttribute("aria-busy","false"),this.search_field.focus()}test_active_click(e){return"left"===this.mousedown_checker(e)&&e.target.up(".chosen-container")===this.container?this.active_field=!0:this.close_field()}results_build(){return this.parsing=!0,this.selected_option_count=null,this.results_data=a.select_to_array(this.form_field,this.parser_config),this.is_multiple?this.search_choices.select("li.search-choice").invoke("remove"):(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold&&!this.create_option?(this.search_field.readOnly=!0,this.container.addClassName("chosen-container-single-nosearch")):(this.search_field.readOnly=!1,this.container.removeClassName("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1}result_do_highlight(e){var t,s,i;return this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClassName("highlighted"),this.search_field.writeAttribute("aria-activedescendant",this.result_highlight.readAttribute("id")),(e=parseInt(this.search_results.getStyle("maxHeight"),10))+(i=this.search_results.scrollTop)<=(t=(s=this.result_highlight.positionedOffset().top)+this.result_highlight.getHeight())?this.search_results.scrollTop=0<t-e?t-e:0:s<i?this.search_results.scrollTop=s:void 0}result_clear_highlight(){return this.result_highlight&&this.result_highlight.removeClassName("highlighted"),this.result_highlight=null}results_show(){var e;return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field.fire("chosen:maxselected",{chosen:this}),!1):(this.should_dropup()&&this.container.addClassName("chosen-dropup"),this.container.addClassName("chosen-with-drop"),(e=this.container.down(".chosen-single div"))&&e.writeAttribute("aria-label","Hide options"),this.results_showing=!0,this.search_field.writeAttribute("aria-expanded","true"),this.search_field.focus(),this.search_field.value=this.get_search_field_value(),this.winnow_results(),this.form_field.fire("chosen:showing_dropdown",{chosen:this}))}update_results_content(e){return this.search_results.update(e)}fire_search_updated(e){return this.form_field.fire("chosen:search_updated",{chosen:this,search_term:e})}results_hide(){var e;return this.results_showing&&(this.result_clear_highlight(),this.container.removeClassName("chosen-with-drop"),this.container.removeClassName("chosen-dropup"),(e=this.container.down(".chosen-single div"))&&e.writeAttribute("aria-label","Show options"),this.form_field.fire("chosen:hiding_dropdown",{chosen:this})),this.search_field.writeAttribute("aria-expanded","false"),this.results_showing=!1}set_tab_index(e){var t;if(this.form_field.tabIndex)return t=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field.tabIndex=t}set_label_behavior(){if(this.form_field_label=this.form_field.up("label"),null==this.form_field_label&&(this.form_field_label=$$(`label[for='${this.form_field.id}']`).first()),null!=this.form_field_label)return this.form_field_label.observe("click",this.label_click_handler)}set_search_field_placeholder(){return this.is_multiple&&this.choices_count()<1?this.search_field.placeholder=this.default_text:this.search_field.placeholder=""}show_search_field_default(){return this.search_field.value="",this.set_search_field_placeholder(),this.is_multiple&&this.choices_count()<1&&!this.active_field?this.search_field.addClassName("default"):this.search_field.removeClassName("default")}search_results_mouseup(e){var t;if("left"===this.mousedown_checker(e)&&(t=e.target.hasClassName("active-result")?e.target:e.target.up(".active-result")))return this.result_highlight=t,this.result_select(e),this.search_field.focus()}search_results_mouseover(e){e=e.target.hasClassName("active-result")?e.target:e.target.up(".active-result");if(e)return this.result_do_highlight(e)}search_results_mouseout(e){if(e.target.hasClassName("active-result")||e.target.up(".active-result"))return this.result_clear_highlight()}choice_build(e){var t,s=new Element("li",{class:"search-choice","data-value":e.value,role:"option"}).update(`<span>${this.choice_label(e)}</span>`);return e.disabled?s.addClassName("search-choice-disabled"):((t=new Element("button",{type:"button",tabindex:-1,class:"search-choice-close",rel:e.data["data-option-array-index"]}).update('<span class="visually-hidden focusable">'+i.default_remove_item_text+"</span>")).observe("click",e=>this.choice_destroy_link_click(e)),s.insert(t)),this.inherit_option_classes&&e.classes&&s[0].classList.add(e.classes),this.search_container.insert({before:s})}choice_destroy_link_click(e){if(e.preventDefault(),e.stopPropagation(),!this.is_disabled)return this.choice_destroy(e.target)}choice_destroy(e){if(this.result_deselect(e.readAttribute("rel")))return this.active_field?this.search_field.focus():this.show_search_field_default(),this.is_multiple&&this.hide_results_on_select&&0<this.choices_count()&&this.get_search_field_value().length<1&&this.results_hide(),e.up("li").remove(),this.set_search_field_placeholder(),this.search_field_scale()}results_reset(){if(this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.trigger_form_field_change(),this.active_field)return this.results_hide()}results_reset_cleanup(){var e;if(this.current_selectedIndex=this.form_field.selectedIndex,e=this.selected_item.down(".search-choice-close"))return e.remove()}result_select(e){var t;if(this.result_highlight)return(t=this.result_highlight).hasClassName("create-option")?(this.select_create_option(this.search_field.value),this.results_hide()):(this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field.fire("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?t.removeClassName("active-result"):this.reset_single_select_options(),t.addClassName("result-selected"),(t=this.results_data[t.getAttribute("data-option-array-index")]).selected=!0,this.form_field.options[t.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(t):this.single_set_selected_text(this.choice_label(t)),this.is_multiple&&(!this.hide_results_on_select||e.metaKey||e.ctrlKey)?e.metaKey||e.ctrlKey?this.winnow_results({skip_highlight:!0}):(this.search_field.value="",this.winnow_results()):(this.results_hide(),this.show_search_field_default()),!this.is_multiple&&this.form_field.selectedIndex===this.current_selectedIndex||this.trigger_form_field_change(),this.current_selectedIndex=this.form_field.selectedIndex,e.preventDefault(),this.search_field_scale()))}single_set_selected_text(e=this.default_text){return e===this.default_text?(this.selected_item.addClassName("chosen-default"),e=this.escape_html(e)):(this.single_deselect_control_build(),this.selected_item.removeClassName("chosen-default")),this.selected_item.down("span").update(e)}result_deselect(e){e=this.results_data[e];return!this.form_field.options[e.options_index].disabled&&(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.trigger_form_field_change(),this.search_field_scale(),!0)}single_deselect_control_build(){if(this.allow_single_deselect)return this.selected_item.down(".search-choice-close")||this.selected_item.down("span").insert({after:'<button type="button" tabindex="-1" class="search-choice-close"></button>'}),this.selected_item.addClassName("chosen-single-with-deselect")}get_search_field_value(){return this.search_field.value}get_search_text(){return this.get_search_field_value().strip()}escape_html(e){return e.escapeHTML()}unescape_html(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&#x27;/g,"'")}winnow_results_set_highlight(){var e;if(null!=(e=null==(e=this.is_multiple?e:this.search_results.down(".result-selected.active-result"))?this.search_results.down(".active-result"):e))return this.result_do_highlight(e)}no_results(e){return this.search_results.insert(this.get_no_results_html(e)),this.form_field.fire("chosen:no_results",{chosen:this})}show_create_option(t){var e=this.get_create_option_html(t);return this.search_results.insert(e),this.search_results.down(".create-option").observe("click",e=>this.select_create_option(t))}create_option_clear(){for(var e=null,t=[];e=this.search_results.down(".create-option");)t.push(e.remove());return t}select_create_option(e){return Object.isFunction(this.create_option)?this.create_option.call(this,e):this.select_append_option({value:e,text:e})}select_append_option(e){if(this.form_field.insert(this.get_option_html(e)),Event.fire(this.form_field,"chosen:updated"),"function"==typeof Event.simulate)return this.form_field.simulate("change"),this.search_field.simulate("focus")}no_results_clear(){for(var e=null,t=[];e=this.search_results.down(".no-results");)t.push(e.remove());return t}keydown_arrow(){var e;return this.results_showing&&this.result_highlight?(e=this.result_highlight.next(".active-result"))?this.result_do_highlight(e):void 0:this.results_showing&&this.create_option?this.result_do_highlight(this.search_results.select(".create-option").first()):this.results_show()}keyup_arrow(){var e,t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.previousSiblings(),e=this.search_results.select("li.active-result"),(t=t.intersect(e)).length?this.result_do_highlight(t.first()):(0<this.choices_count()&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()}keydown_backstroke(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.down(".search-choice-close")),this.clear_backstroke()):(e=this.search_container.siblings().last())&&e.hasClassName("search-choice")&&!e.hasClassName("search-choice-disabled")?(this.pending_backstroke=e,this.pending_backstroke&&this.pending_backstroke.addClassName("search-choice-focus"),this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClassName("search-choice-focus")):void 0}clear_backstroke(){return this.pending_backstroke&&this.pending_backstroke.removeClassName("search-choice-focus"),this.pending_backstroke=null}search_field_scale(){var e,t,s,i,l,h,r;if(this.is_multiple){for(l={position:"absolute",left:"-1000px",top:"-1000px",display:"none",whiteSpace:"pre"},t=0,s=(h=["fontSize","fontStyle","fontWeight","fontFamily","lineHeight","textTransform","letterSpacing"]).length;t<s;t++)l[i=h[t]]=this.search_field.getStyle(i);return(e=new Element("div").update(this.escape_html(this.get_search_field_value()||this.search_field.placeholder))).setStyle(l),document.body.appendChild(e),r=e.measure("width")+25,e.remove(),(e=this.container.getWidth())&&(r=Math.min(e-10,r)),this.search_field.setStyle({width:r+"px"})}}trigger_form_field_change(){return e(this.form_field,"input"),e(this.form_field,"change")}}return e=function(e,t){var s;if(e.dispatchEvent){try{s=new Event(t,{bubbles:!0,cancelable:!0})}catch(e){(s=document.createEvent("HTMLEvents")).initEvent(t,!0,!0)}return e.dispatchEvent(s)}return e.fireEvent("on"+t,document.createEventObject())},t}.call(this)}.call(this);